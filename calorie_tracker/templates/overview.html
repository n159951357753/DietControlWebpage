{% extends 'base.html' %}
{% block content %}
<h3 class="mt-4 text-primary">ğŸ“Š ä»Šæ—¥ç¸½è¦½</h3>

<div class="card mb-3 border-info">
    <div class="card-header bg-info text-white">
        ğŸ‘¤ å€‹äººåŸºæœ¬è³‡æ–™
    </div>
    <div class="card-body">
        <ul class="list-group list-group-flush">
            <li class="list-group-item">å§“åï¼š<strong>{{ current_user.name }}</strong></li>
            <li class="list-group-item">ç”Ÿæ—¥ï¼š<strong>{{ current_user.birthdate }}</strong></li>
            <li class="list-group-item">å¹´é½¡ï¼š<strong>{{ age }} æ­²</strong></li>
            <li class="list-group-item">æ€§åˆ¥ï¼š<strong>{{ current_user.gender }}</strong></li>
            <li class="list-group-item">èº«é«˜ï¼š<strong>{{ current_user.height }} cm</strong></li>
            <li class="list-group-item">é«”é‡ï¼š<strong>{{ current_user.weight }} kg</strong></li>
        </ul>
    </div>
</div>

<div class="card mb-3 border-success">
    <div class="card-header bg-success text-white">
        ğŸ± å¡è·¯é‡Œè³‡è¨Š
    </div>
    <div class="card-body">
        <ul class="list-group list-group-flush">
            <li class="list-group-item">
                ä»Šæ—¥æ”å–å¡è·¯é‡Œï¼š<strong class="text-success">{{ total_calories }} kcal</strong>
            </li>
            <li class="list-group-item">
                å»ºè­°æ”å–å¡è·¯é‡Œï¼š
                <strong class="text-primary">
                    {{ suggested_calories + calorie_adjustment }} kcal 
                    (æ¨™æº– [{{ suggested_calories }}] + å»ºè­° [{% if calorie_adjustment > 0 %}+{% endif %}{{ calorie_adjustment }}])
                </strong>
            </li>
            <li class="list-group-item">
                æœ¬æ—¥è·é›¢ç›®æ¨™å¡è·¯é‡Œï¼š
                <strong>
                {% set gap = suggested_calories + calorie_adjustment - total_calories %}
                {% if gap >= 50 %}
                    <span class="text-warning">
                        é‚„å¯ä»¥å¢åŠ  {{ gap }} kcal
                    </span>
                {% elif gap <= -50 %}
                    <span class="text-danger">
                        æ‡‰è©²è¦æ¸›å°‘ {{ gap | abs }} kcal
                    </span>
                {% else %}
                    <span class="text-success">
                        ç¶­æŒä¸è®Š (èª¤å·®åœ¨æ­£è²  50 kcal ä»¥å…§)
                    </span>
                {% endif %}
                </strong>
            </li>
            <li class="list-group-item">
                ğŸ’§ å»ºè­°æ¯æ—¥é£²æ°´é‡ï¼š<strong>{{ suggested_water }} ml</strong>
            </li>
        </ul>
    </div>
</div>

<div class="card mb-3 border-warning">
    <div class="card-header bg-warning text-dark">
        âš–ï¸ BMI èˆ‡é«”é‡è³‡è¨Š
    </div>
    <div class="card-body">
        <ul class="list-group list-group-flush">
            <li class="list-group-item">ç•¶å‰ BMIï¼š<strong>{{ bmi }}</strong> ({{ bmi_category }})</li>
            <li class="list-group-item">å»ºè­° BMIï¼š<strong>{{ suggested_bmi }}</strong></li>
            <li class="list-group-item">å»ºè­°é«”é‡ï¼š<strong>{{ suggested_weight }} kg</strong></li>
            <li class="list-group-item">
                æ‡‰å¢æ¸›é«”é‡ï¼š
                <strong>
                {% if weight_diff > 0 %}
                    <span class="text-warning">å¢åŠ  {{ weight_diff }} kg</span>
                {% elif weight_diff < 0 %}
                    <span class="text-danger">æ¸›å°‘ {{ weight_diff | abs }} kg</span>
                {% else %}
                    <span class="text-success">ç¶­æŒä¸è®Š</span>
                {% endif %}
                </strong>
            </li>
        </ul>
    </div>
</div>


<table class="table table-striped">
    <tr>
        <th>é€²é£Ÿæ™‚é–“</th>
        <th>é£Ÿå“åç¨±</th>
        <th>å¡è·¯é‡Œ</th>
    </tr>
    {% for record in records %}
    <tr>
        <td>{{ record.timestamp }}</td>
        <td>{{ record.food_name }}</td>
        <td>{{ record.calories }}</td>
    </tr>
    {% endfor %}
</table>
{% endblock %}
